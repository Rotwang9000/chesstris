<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Shaktris - Minimal Version</title>
	<meta name="description" content="Shaktris minimal version for debugging and testing.">
	
	<!-- Libraries -->
	<script src="https://cdn.jsdelivr.net/npm/three@0.132.2/build/three.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/three@0.132.2/examples/js/controls/OrbitControls.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/socket.io-client@4.7.2/dist/socket.io.min.js"></script>
	
	<style>
		body, html {
			margin: 0;
			padding: 0;
			width: 100%;
			height: 100%;
			overflow: hidden;
			font-family: Arial, sans-serif;
			background-color: #000;
		}
		
		#loading {
			position: fixed;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			background-color: #000;
			display: flex;
			justify-content: center;
			align-items: center;
			z-index: 1000;
			color: white;
			font-size: 2em;
		}
		
		#error-message {
			position: fixed;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			background-color: rgba(0, 0, 0, 0.9);
			display: none;
			justify-content: center;
			align-items: center;
			z-index: 1001;
			color: #ff5555;
			font-size: 1.5em;
			text-align: center;
			padding: 20px;
		}
		
		#game-container {
			position: fixed;
			top: 0;
			left: 0;
			width: 100%;
			height: 100vh !important;
			min-height: 100vh !important;
			z-index: 1;
		}
		
		#game-container canvas {
			display: block;
			width: 100% !important;
			height: 100% !important;
		}
		
		.game-title {
			position: fixed;
			top: 10px;
			left: 10px;
			z-index: 100;
			color: white;
			font-size: 24px;
			font-weight: bold;
			text-shadow: 0 0 10px rgba(0, 0, 0, 0.7);
		}
		
		.minimal-badge {
			position: fixed;
			top: 15px;
			left: 100px;
			color: white;
			font-size: 12px;
			z-index: 100;
			background-color: rgba(0, 0, 0, 0.7);
			padding: 2px 6px;
			border-radius: 10px;
		}
		
		.navigation {
			position: fixed;
			top: 10px;
			left: 170px;
			z-index: 1000;
			background-color: rgba(0, 0, 0, 0.7);
			padding: 10px;
			border-radius: 5px;
		}
		
		.navigation .title {
			color: white;
			font-weight: bold;
			margin-bottom: 8px;
		}
		
		.navigation a {
			color: #3498db;
			margin-right: 10px;
			text-decoration: none;
		}
		
		.navigation a.active {
			font-weight: bold;
			text-decoration: underline;
		}
	</style>
</head>
<body>
	<!-- Game Title -->
	<div class="game-title">SHAKTRIS</div>
	<div class="minimal-badge">MINIMAL VERSION</div>
	
	<!-- Navigation Menu -->
	<div class="navigation">
		<div class="title">Navigation</div>
		<a href="index.html">Main Game</a>
		<a href="enhanced-game.html">Russian Theme</a>
		<a href="minimal.html" class="active">Minimal Version</a>
	</div>
	
	<!-- Loading Screen -->
	<div id="loading">
		Loading Minimal Shaktris...
	</div>
	
	<!-- Error Message -->
	<div id="error-message"></div>
	
	<!-- Game Container -->
	<div id="game-container" style="display: none;"></div>
	
	<!-- Core scripts -->
	<script src="js/utils/debugUtils.js" type="module"></script>
	<script src="js/networkStatus.js"></script>
	<script src="js/minimal-main.js" type="module"></script>
	
	<script type="module">
		// Import the minimal game core directly
		import * as gameCore from './js/minimal-gameCore.js';
		
		// Start initialization when page loads
		window.addEventListener('load', initGame);
		
		async function initGame() {
			try {
				// Initialize NetworkStatusManager if available
				if (window.NetworkStatusManager) {
					window.NetworkStatusManager.init();
					
					// Add status listener
					window.NetworkStatusManager.addStatusListener((status) => {
						if (status === window.NetworkStatusManager.NetworkStatus.DISCONNECTED) {
							console.log('Network connection lost, game paused');
							// If game is running and has pause function, pause it
							if (gameCore.pauseGame) {
								gameCore.pauseGame();
							}
						} else if (status === window.NetworkStatusManager.NetworkStatus.CONNECTED) {
							console.log('Network connection restored');
							// If game was paused due to disconnect, resume it
							if (gameCore.resumeGame) {
								gameCore.resumeGame();
							}
						}
					});
				}
				
				// Hide loading screen, show game container
				document.getElementById('loading').style.display = 'none';
				
				const gameContainer = document.getElementById('game-container');
				gameContainer.style.display = 'block';
				
				// Initialize the game
				console.log('Starting minimal game initialization...');
				const success = gameCore.initGame(gameContainer);
				
				if (!success) {
					throw new Error('Game initialization failed');
				}
				
				// Set up resize handler
				window.addEventListener('resize', () => {
					gameCore.updateRenderSize();
				});
				
				console.log('Minimal game initialized successfully');
			} catch (error) {
				console.error('Error initializing game:', error);
				
				// Show error message
				const errorElement = document.getElementById('error-message');
				if (errorElement) {
					errorElement.innerHTML = `
						<h3>Error Starting Game</h3>
						<p>${error.message}</p>
						<div style="margin-top: 15px;">
							<button onclick="window.location.reload()">Reload</button>
						</div>
					`;
					errorElement.style.display = 'flex';
				}
				
				// Hide loading screen
				document.getElementById('loading').style.display = 'none';
			}
		}
	</script>
</body>
</html> 